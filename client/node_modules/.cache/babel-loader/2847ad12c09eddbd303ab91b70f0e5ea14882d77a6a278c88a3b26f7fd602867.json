{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import WeatherDisplay from'./components/WeatherDisplay';import CityList from'./components/CityList';import CityForm from'./components/CityForm';import'./styles.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const OPENWEATHER_API_KEY='d5b9892542a831a20e5cde81df11674e';function App(){const[weather,setWeather]=useState(null);const[cities,setCities]=useState([]);const[currentCity,setCurrentCity]=useState('');const[loading,setLoading]=useState(false);const[error,setError]=useState('');useEffect(()=>{fetchCities();},[]);const fetchCities=async()=>{try{const response=await axios.get('/api/cities');setCities(response.data);}catch(err){setError('Failed to fetch cities');console.error(err);}};const fetchWeather=async city=>{setLoading(true);setError('');try{const response=await axios.get(`https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${OPENWEATHER_API_KEY}&units=metric&lang=ru`);setWeather(response.data);setCurrentCity(city);}catch(err){setError('City not found');setWeather(null);}finally{setLoading(false);}};const addCity=async city=>{try{const response=await axios.post('/api/cities',{name:city});setCities([...cities,response.data]);fetchWeather(city);}catch(err){var _err$response,_err$response$data;if(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)==='City already exists'){setError('This city is already in your list');fetchWeather(city);}else{setError('Failed to add city');}}};const updateCity=async(id,oldName,newName)=>{try{await axios.put(`/api/cities/${id}`,{name:newName});const updatedCities=cities.map(city=>city.id===id?{...city,name:newName}:city);setCities(updatedCities);if(currentCity===oldName){fetchWeather(newName);}}catch(err){setError('Failed to update city');}};const deleteCity=async(id,cityName)=>{try{await axios.delete(`/api/cities/${id}`);const updatedCities=cities.filter(city=>city.id!==id);setCities(updatedCities);if(currentCity===cityName){setWeather(null);setCurrentCity('');}}catch(err){setError('Failed to delete city');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"app\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Weather App\"}),/*#__PURE__*/_jsx(CityForm,{onAddCity:addCity,onFetchWeather:fetchWeather}),loading&&/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"error\",children:error}),/*#__PURE__*/_jsx(WeatherDisplay,{weather:weather}),/*#__PURE__*/_jsx(CityList,{cities:cities,currentCity:currentCity,onSelectCity:city=>fetchWeather(city.name),onUpdateCity:updateCity,onDeleteCity:deleteCity})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","axios","WeatherDisplay","CityList","CityForm","jsx","_jsx","jsxs","_jsxs","OPENWEATHER_API_KEY","App","weather","setWeather","cities","setCities","currentCity","setCurrentCity","loading","setLoading","error","setError","fetchCities","response","get","data","err","console","fetchWeather","city","addCity","post","name","_err$response","_err$response$data","updateCity","id","oldName","newName","put","updatedCities","map","deleteCity","cityName","delete","filter","className","children","onAddCity","onFetchWeather","onSelectCity","onUpdateCity","onDeleteCity"],"sources":["C:/Users/ddgol/Desktop/weather-app-devops/client/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport WeatherDisplay from './components/WeatherDisplay';\r\nimport CityList from './components/CityList';\r\nimport CityForm from './components/CityForm';\r\nimport './styles.css';\r\n\r\nconst OPENWEATHER_API_KEY = 'd5b9892542a831a20e5cde81df11674e';\r\n\r\nfunction App() {\r\n  const [weather, setWeather] = useState(null);\r\n  const [cities, setCities] = useState([]);\r\n  const [currentCity, setCurrentCity] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n\r\n  useEffect(() => {\r\n    fetchCities();\r\n  }, []);\r\n\r\n  const fetchCities = async () => {\r\n    try {\r\n      const response = await axios.get('/api/cities');\r\n      setCities(response.data);\r\n    } catch (err) {\r\n      setError('Failed to fetch cities');\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  const fetchWeather = async (city) => {\r\n    setLoading(true);\r\n    setError('');\r\n    try {\r\n      const response = await axios.get(\r\n        `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${OPENWEATHER_API_KEY}&units=metric&lang=ru`\r\n      );\r\n      setWeather(response.data);\r\n      setCurrentCity(city);\r\n    } catch (err) {\r\n      setError('City not found');\r\n      setWeather(null);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const addCity = async (city) => {\r\n    try {\r\n      const response = await axios.post('/api/cities', { name: city });\r\n      setCities([...cities, response.data]);\r\n      fetchWeather(city);\r\n    } catch (err) {\r\n      if (err.response?.data?.error === 'City already exists') {\r\n        setError('This city is already in your list');\r\n        fetchWeather(city);\r\n      } else {\r\n        setError('Failed to add city');\r\n      }\r\n    }\r\n  };\r\n\r\n  const updateCity = async (id, oldName, newName) => {\r\n    try {\r\n      await axios.put(`/api/cities/${id}`, { name: newName });\r\n      const updatedCities = cities.map(city =>\r\n        city.id === id ? { ...city, name: newName } : city\r\n      );\r\n      setCities(updatedCities);\r\n      if (currentCity === oldName) {\r\n        fetchWeather(newName);\r\n      }\r\n    } catch (err) {\r\n      setError('Failed to update city');\r\n    }\r\n  };\r\n\r\n  const deleteCity = async (id, cityName) => {\r\n    try {\r\n      await axios.delete(`/api/cities/${id}`);\r\n      const updatedCities = cities.filter(city => city.id !== id);\r\n      setCities(updatedCities);\r\n      if (currentCity === cityName) {\r\n        setWeather(null);\r\n        setCurrentCity('');\r\n      }\r\n    } catch (err) {\r\n      setError('Failed to delete city');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"app\">\r\n      <h1>Weather App</h1>\r\n\r\n      <CityForm\r\n        onAddCity={addCity}\r\n        onFetchWeather={fetchWeather}\r\n      />\r\n\r\n      {loading && <p>Loading...</p>}\r\n      {error && <p className=\"error\">{error}</p>}\r\n\r\n      <WeatherDisplay weather={weather} />\r\n\r\n      <CityList\r\n        cities={cities}\r\n        currentCity={currentCity}\r\n        onSelectCity={(city) => fetchWeather(city.name)}\r\n        onUpdateCity={updateCity}\r\n        onDeleteCity={deleteCity}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,cAAc,KAAM,6BAA6B,CACxD,MAAO,CAAAC,QAAQ,KAAM,uBAAuB,CAC5C,MAAO,CAAAC,QAAQ,KAAM,uBAAuB,CAC5C,MAAO,cAAc,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEtB,KAAM,CAAAC,mBAAmB,CAAG,kCAAkC,CAE9D,QAAS,CAAAC,GAAGA,CAAA,CAAG,CACb,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAGb,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACc,MAAM,CAAEC,SAAS,CAAC,CAAGf,QAAQ,CAAC,EAAE,CAAC,CACxC,KAAM,CAACgB,WAAW,CAAEC,cAAc,CAAC,CAAGjB,QAAQ,CAAC,EAAE,CAAC,CAClD,KAAM,CAACkB,OAAO,CAAEC,UAAU,CAAC,CAAGnB,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAACoB,KAAK,CAAEC,QAAQ,CAAC,CAAGrB,QAAQ,CAAC,EAAE,CAAC,CAEtCC,SAAS,CAAC,IAAM,CACdqB,WAAW,CAAC,CAAC,CACf,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAA,WAAW,CAAG,KAAAA,CAAA,GAAY,CAC9B,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAArB,KAAK,CAACsB,GAAG,CAAC,aAAa,CAAC,CAC/CT,SAAS,CAACQ,QAAQ,CAACE,IAAI,CAAC,CAC1B,CAAE,MAAOC,GAAG,CAAE,CACZL,QAAQ,CAAC,wBAAwB,CAAC,CAClCM,OAAO,CAACP,KAAK,CAACM,GAAG,CAAC,CACpB,CACF,CAAC,CAED,KAAM,CAAAE,YAAY,CAAG,KAAO,CAAAC,IAAI,EAAK,CACnCV,UAAU,CAAC,IAAI,CAAC,CAChBE,QAAQ,CAAC,EAAE,CAAC,CACZ,GAAI,CACF,KAAM,CAAAE,QAAQ,CAAG,KAAM,CAAArB,KAAK,CAACsB,GAAG,CAC9B,qDAAqDK,IAAI,UAAUnB,mBAAmB,uBACxF,CAAC,CACDG,UAAU,CAACU,QAAQ,CAACE,IAAI,CAAC,CACzBR,cAAc,CAACY,IAAI,CAAC,CACtB,CAAE,MAAOH,GAAG,CAAE,CACZL,QAAQ,CAAC,gBAAgB,CAAC,CAC1BR,UAAU,CAAC,IAAI,CAAC,CAClB,CAAC,OAAS,CACRM,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED,KAAM,CAAAW,OAAO,CAAG,KAAO,CAAAD,IAAI,EAAK,CAC9B,GAAI,CACF,KAAM,CAAAN,QAAQ,CAAG,KAAM,CAAArB,KAAK,CAAC6B,IAAI,CAAC,aAAa,CAAE,CAAEC,IAAI,CAAEH,IAAK,CAAC,CAAC,CAChEd,SAAS,CAAC,CAAC,GAAGD,MAAM,CAAES,QAAQ,CAACE,IAAI,CAAC,CAAC,CACrCG,YAAY,CAACC,IAAI,CAAC,CACpB,CAAE,MAAOH,GAAG,CAAE,KAAAO,aAAA,CAAAC,kBAAA,CACZ,GAAI,EAAAD,aAAA,CAAAP,GAAG,CAACH,QAAQ,UAAAU,aAAA,kBAAAC,kBAAA,CAAZD,aAAA,CAAcR,IAAI,UAAAS,kBAAA,iBAAlBA,kBAAA,CAAoBd,KAAK,IAAK,qBAAqB,CAAE,CACvDC,QAAQ,CAAC,mCAAmC,CAAC,CAC7CO,YAAY,CAACC,IAAI,CAAC,CACpB,CAAC,IAAM,CACLR,QAAQ,CAAC,oBAAoB,CAAC,CAChC,CACF,CACF,CAAC,CAED,KAAM,CAAAc,UAAU,CAAG,KAAAA,CAAOC,EAAE,CAAEC,OAAO,CAAEC,OAAO,GAAK,CACjD,GAAI,CACF,KAAM,CAAApC,KAAK,CAACqC,GAAG,CAAC,eAAeH,EAAE,EAAE,CAAE,CAAEJ,IAAI,CAAEM,OAAQ,CAAC,CAAC,CACvD,KAAM,CAAAE,aAAa,CAAG1B,MAAM,CAAC2B,GAAG,CAACZ,IAAI,EACnCA,IAAI,CAACO,EAAE,GAAKA,EAAE,CAAG,CAAE,GAAGP,IAAI,CAAEG,IAAI,CAAEM,OAAQ,CAAC,CAAGT,IAChD,CAAC,CACDd,SAAS,CAACyB,aAAa,CAAC,CACxB,GAAIxB,WAAW,GAAKqB,OAAO,CAAE,CAC3BT,YAAY,CAACU,OAAO,CAAC,CACvB,CACF,CAAE,MAAOZ,GAAG,CAAE,CACZL,QAAQ,CAAC,uBAAuB,CAAC,CACnC,CACF,CAAC,CAED,KAAM,CAAAqB,UAAU,CAAG,KAAAA,CAAON,EAAE,CAAEO,QAAQ,GAAK,CACzC,GAAI,CACF,KAAM,CAAAzC,KAAK,CAAC0C,MAAM,CAAC,eAAeR,EAAE,EAAE,CAAC,CACvC,KAAM,CAAAI,aAAa,CAAG1B,MAAM,CAAC+B,MAAM,CAAChB,IAAI,EAAIA,IAAI,CAACO,EAAE,GAAKA,EAAE,CAAC,CAC3DrB,SAAS,CAACyB,aAAa,CAAC,CACxB,GAAIxB,WAAW,GAAK2B,QAAQ,CAAE,CAC5B9B,UAAU,CAAC,IAAI,CAAC,CAChBI,cAAc,CAAC,EAAE,CAAC,CACpB,CACF,CAAE,MAAOS,GAAG,CAAE,CACZL,QAAQ,CAAC,uBAAuB,CAAC,CACnC,CACF,CAAC,CAED,mBACEZ,KAAA,QAAKqC,SAAS,CAAC,KAAK,CAAAC,QAAA,eAClBxC,IAAA,OAAAwC,QAAA,CAAI,aAAW,CAAI,CAAC,cAEpBxC,IAAA,CAACF,QAAQ,EACP2C,SAAS,CAAElB,OAAQ,CACnBmB,cAAc,CAAErB,YAAa,CAC9B,CAAC,CAEDV,OAAO,eAAIX,IAAA,MAAAwC,QAAA,CAAG,YAAU,CAAG,CAAC,CAC5B3B,KAAK,eAAIb,IAAA,MAAGuC,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAE3B,KAAK,CAAI,CAAC,cAE1Cb,IAAA,CAACJ,cAAc,EAACS,OAAO,CAAEA,OAAQ,CAAE,CAAC,cAEpCL,IAAA,CAACH,QAAQ,EACPU,MAAM,CAAEA,MAAO,CACfE,WAAW,CAAEA,WAAY,CACzBkC,YAAY,CAAGrB,IAAI,EAAKD,YAAY,CAACC,IAAI,CAACG,IAAI,CAAE,CAChDmB,YAAY,CAAEhB,UAAW,CACzBiB,YAAY,CAAEV,UAAW,CAC1B,CAAC,EACC,CAAC,CAEV,CAEA,cAAe,CAAA/B,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}